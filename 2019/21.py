from Intcode import Intcode,load_intcode
from itertools import product

VERBOSE=True

CODE=load_intcode("21.txt")

class Ascii(Intcode):
    def __init__(self, stdin=''):
        super().__init__(CODE)
        del self._out_q
        del self._in_q
        self.out=""
        self.stdin=iter(stdin)
    def _4(s):
        if s.out[-2:]=="\n\n":
            if VERBOSE: print(s.out);s.out=''
        try:
            s.out+=chr(s._code[s.par(1)])
        except ValueError:
            print('Non ASCII Value:',s._code[s.par(1)])
        s._i+=2
    def _3(s):
        try:
            s._code[s.par(1)]=ord(next(s.stdin))
        except StopIteration:
            s.awaiting_input=True
        s._i+=2

springscript="""
OR A T
AND B T
AND C T
NOT T T
OR D J
AND T J
WALK
""".lstrip()
springdroid = Ascii(springscript)
springdroid.run()

# Every spring script command
#instructions = ['AND','OR','NOT']
#r_regs = 'ABCD'
#rw_regs = 'JT'

#walk_script_set = [f"{i} {r} {w}" for i,r,w in product(instructions,r_regs,rw_regs)]
#for l in range(1,16):
    #for steps in product(walk_script_set,repeat=l):
        #springscript = '\n'.join(steps)+'\nWALK\n'
        #springdroid = Ascii(springscript)
        #springdroid.run()

quit()
#-----------------------Part 2----------------------
print('\n\n'+'-'*30+' Part 2 '+'-'*30)

def jump_or_no_jump(pattern):
    if pattern[1]=='.':return True
    if pattern[4]=='.':return False


#j=int(2**10)
#t=str.maketrans('01','.#')
#for i in range(1,2**10):
    #o=bin(i+j)[2:].translate(t)
    #if not '.'*4 in o and not o[1]=='.'==o[4]:  # Any gaps larger than 3 are impossible
        #print(o)

# Every spring script command
#r_regs = 'ABCDEFGHIJT'
#run_script_set = [f"{i} {r} {w}" for i,r,w in product(instructions,r_regs,rw_regs)]

springscript2="""
NOT T T
AND A T
AND B T
AND C T
NOT T T
OR D J
AND T J
RUN
""".lstrip()
springdroid2 = Ascii(springscript2)
springdroid2.run()
print(springdroid2.out)

"""
#...#...#..  J
#...#...#.#  J
#...#...##.  J
#...#...###  J
#...#..#...  J
#...#..#..#  J
#...#..#.#.  J
#...#..#.##  J
#...#..##..  J
#...#..##.#  J
#...#..###.  J
#...#..####  J
#...#.#...#  J
#...#.#..#.  J
#...#.#..##  J
#...#.#.#..  J
#...#.#.#.#  J
#...#.#.##.  J
#...#.#.###  J
#...#.##...  J
#...#.##..#  J
#...#.##.#.  J
#...#.##.##  J
#...#.###..  J
#...#.###.#  J
#...#.####.  J
#...#.#####  J
#...##...#.  J
#...##...##  J
#...##..#..  J
#...##..#.#  J
#...##..##.  J
#...##..###  J
#...##.#...  J
#...##.#..#  J
#...##.#.#.  J
#...##.#.##  J
#...##.##..  J
#...##.##.#  J
#...##.###.  J
#...##.####  J
#...###...#  J
#...###..#.  J
#...###..##  J
#...###.#..  J
#...###.#.#  J
#...###.##.  J
#...###.###  J
#...####...  J
#...####..#  J
#...####.#.  J
#...####.##  J
#...#####..  J
#...#####.#  J
#...######.  J
#...#######  J
#..##...#..  J
#..##...#.#  J
#..##...##.  J
#..##...###  J
#..##..##..  J
#..##..##.#  J
#..##..###.  J
#..##..####  J
#..##.#.#..  J
#..##.#.#.#  J
#..##.#.##.  J
#..##.#.###  J
#..##.###..  J
#..##.###.#  J
#..##.####.  J
#..##.#####  J
#..###...#.  J
#..###...##  J
#..###..#..  J
#..###..#.#  J
#..###..##.  J
#..###..###  J
#..###.#.#.  J
#..###.#.##  J
#..###.##..  J
#..###.##.#  J
#..###.###.  J
#..###.####  J
#..####...#  J
#..####..#.  J
#..####..##  J
#..####.#..  J
#..####.#.#  J
#..####.##.  J
#..####.###  J
#..#####...  J
#..#####..#  J
#..#####.#.  J
#..#####.##  J
#..######..  J
#..######.#  J
#..#######.  J
#..########  J
#.#.#...#..  J
#.#.#...#.#  J
#.#.#...##.  J
#.#.#...###  J
#.#.#..##..  J
#.#.#..##.#  J
#.#.#..###.  J
#.#.#..####  J
#.#.#.#.#..  J
#.#.#.#.#.#  J
#.#.#.#.##.  J
#.#.#.#.###  J
#.#.#.###..  J
#.#.#.###.#  J
#.#.#.####.  J
#.#.#.#####  J
#.#.##...#.  J
#.#.##...##  J
#.#.##..#..  J
#.#.##..#.#  J
#.#.##..##.  J
#.#.##..###  J
#.#.##.#.#.  J
#.#.##.#.##  J
#.#.##.##..  J
#.#.##.##.#  J
#.#.##.###.  J
#.#.##.####  J
#.#.###...#  J
#.#.###..#.  J
#.#.###..##  J
#.#.###.#..  J
#.#.###.#.#  J
#.#.###.##.  J
#.#.###.###  J
#.#.####..#  J
#.#.####.#.  J
#.#.####.##  J
#.#.#####..
#.#.#####.#
#.#.######.
#.#.#######
#.###...#..
#.###...#.#
#.###...##.
#.###...###
#.###..#...
#.###..#..#
#.###..#.#.
#.###..#.##
#.###..##..
#.###..##.#
#.###..###.
#.###..####
#.###.#...#
#.###.#..#.
#.###.#..##
#.###.#.#..
#.###.#.#.#
#.###.#.##.
#.###.#.###
#.###.##...
#.###.##..#
#.###.##.#.
#.###.##.##
#.###.###..
#.###.###.#
#.###.####.
#.###.#####
#.####...#.
#.####...##
#.####..#..
#.####..#.#
#.####..##.
#.####..###
#.####.#...
#.####.#..#
#.####.#.#.
#.####.#.##
#.####.##..
#.####.##.#
#.####.###.
#.####.####
#.#####...#
#.#####..#.
#.#####..##
#.#####.#..
#.#####.#.#
#.#####.##.
#.#####.###
#.######...
#.######..#
#.######.#.
#.######.##
#.#######..
#.#######.#
#.########.
#.#########
##...#...#.
##...#...##
##...#..#..
##...#..#.#
##...#..##.
##...#..###
##...#.#...
##...#.#..#
##...#.#.#.
##...#.#.##
##...#.##..
##...#.##.#
##...#.###.
##...#.####
##...##...#
##...##..#.
##...##..##
##...##.#..
##...##.#.#
##...##.##.
##...##.###
##...###...
##...###..#
##...###.#.
##...###.##
##...####..
##...####.#
##...#####.
##...######
##..#...#..
##..#...#.#
##..#...##.
##..#...###
##..#..#...
##..#..#..#
##..#..#.#.
##..#..#.##
##..#..##..
##..#..##.#
##..#..###.
##..#..####
##..#.#...#
##..#.#..#.
##..#.#..##
##..#.#.#..
##..#.#.#.#
##..#.#.##.
##..#.#.###
##..#.##...
##..#.##..#
##..#.##.#.
##..#.##.##
##..#.###..
##..#.###.#
##..#.####.
##..#.#####
##..##...#.
##..##...##
##..##..#..
##..##..#.#
##..##..##.
##..##..###
##..##.#...
##..##.#..#
##..##.#.#.
##..##.#.##
##..##.##..
##..##.##.#
##..##.###.
##..##.####
##..###...#
##..###..#.
##..###..##
##..###.#..
##..###.#.#
##..###.##.
##..###.###
##..####...
##..####..#
##..####.#.
##..####.##
##..#####..
##..#####.#
##..######.
##..#######
##.#...#...
##.#...#..#
##.#...#.#.
##.#...#.##
##.#...##..
##.#...##.#
##.#...###.
##.#...####
##.#..#...#
##.#..#..#.
##.#..#..##
##.#..#.#..
##.#..#.#.#
##.#..#.##.
##.#..#.###
##.#..##...
##.#..##..#
##.#..##.#.
##.#..##.##
##.#..###..
##.#..###.#
##.#..####.
##.#..#####
##.#.#...#.
##.#.#...##
##.#.#..#..
##.#.#..#.#
##.#.#..##.
##.#.#..###
##.#.#.#...
##.#.#.#..#
##.#.#.#.#.
##.#.#.#.##
##.#.#.##..
##.#.#.##.#
##.#.#.###.
##.#.#.####
##.#.##...#
##.#.##..#.
##.#.##..##
##.#.##.#..
##.#.##.#.#
##.#.##.##.
##.#.##.###
##.#.###...
##.#.###..#
##.#.###.#.
##.#.###.##
##.#.####..
##.#.####.#
##.#.#####.
##.#.######
##.##...#..
##.##...#.#
##.##...##.
##.##...###
##.##..#...
##.##..#..#
##.##..#.#.
##.##..#.##
##.##..##..
##.##..##.#
##.##..###.
##.##..####
##.##.#...#
##.##.#..#.
##.##.#..##
##.##.#.#..
##.##.#.#.#
##.##.#.##.
##.##.#.###
##.##.##...
##.##.##..#
##.##.##.#.
##.##.##.##
##.##.###..
##.##.###.#
##.##.####.
##.##.#####
##.###...#.
##.###...##
##.###..#..
##.###..#.#
##.###..##.
##.###..###
##.###.#...
##.###.#..#
##.###.#.#.
##.###.#.##
##.###.##..
##.###.##.#
##.###.###.
##.###.####
##.####...#
##.####..#.
##.####..##
##.####.#..
##.####.#.#
##.####.##.
##.####.###
##.#####...
##.#####..#
##.#####.#.
##.#####.##
##.######..
##.######.#
##.#######.
##.########
###...#...#
###...#..#.
###...#..##
###...#.#..
###...#.#.#
###...#.##.
###...#.###
###...##...
###...##..#
###...##.#.
###...##.##
###...###..
###...###.#
###...####.
###...#####
###..#...#.
###..#...##
###..#..#..
###..#..#.#
###..#..##.
###..#..###
###..#.#...
###..#.#..#
###..#.#.#.
###..#.#.##
###..#.##..
###..#.##.#
###..#.###.
###..#.####
###..##...#
###..##..#.
###..##..##
###..##.#..
###..##.#.#
###..##.##.
###..##.###
###..###...
###..###..#
###..###.#.
###..###.##
###..####..
###..####.#
###..#####.
###..######
###.#...#..
###.#...#.#
###.#...##.
###.#...###
###.#..#...
###.#..#..#
###.#..#.#.
###.#..#.##
###.#..##..
###.#..##.#
###.#..###.
###.#..####
###.#.#...#
###.#.#..#.
###.#.#..##
###.#.#.#..
###.#.#.#.#
###.#.#.##.
###.#.#.###
###.#.##...
###.#.##..#
###.#.##.#.
###.#.##.##
###.#.###..
###.#.###.#
###.#.####.
###.#.#####
###.##...#.
###.##...##
###.##..#..
###.##..#.#
###.##..##.
###.##..###
###.##.#...
###.##.#..#
###.##.#.#.
###.##.#.##
###.##.##..
###.##.##.#
###.##.###.
###.##.####
###.###...#
###.###..#.
###.###..##
###.###.#..
###.###.#.#
###.###.##.
###.###.###
###.####...
###.####..#
###.####.#.
###.####.##
###.#####..
###.#####.#
###.######.
###.#######
####...#...
####...#..#
####...#.#.
####...#.##
####...##..
####...##.#
####...###.
####...####
####..#...#
####..#..#.
####..#..##
####..#.#..
####..#.#.#
####..#.##.
####..#.###
####..##...
####..##..#
####..##.#.
####..##.##
####..###..
####..###.#
####..####.
####..#####
####.#...#.
####.#...##
####.#..#..
####.#..#.#
####.#..##.
####.#..###
####.#.#...
####.#.#..#
####.#.#.#.
####.#.#.##
####.#.##..
####.#.##.#
####.#.###.
####.#.####
####.##...#
####.##..#.
####.##..##
####.##.#..
####.##.#.#
####.##.##.
####.##.###
####.###...
####.###..#
####.###.#.
####.###.##
####.####..
####.####.#
####.#####.
####.######
#####...#..
#####...#.#
#####...##.
#####...###
#####..#...
#####..#..#
#####..#.#.
#####..#.##
#####..##..
#####..##.#
#####..###.
#####..####
#####.#...#
#####.#..#.
#####.#..##
#####.#.#..
#####.#.#.#
#####.#.##.
#####.#.###
#####.##...
#####.##..#
#####.##.#.
#####.##.##
#####.###..
#####.###.#
#####.####.
#####.#####
######...#.
######...##
######..#..
######..#.#
######..##.
######..###
######.#...
######.#..#
######.#.#.
######.#.##
######.##..
######.##.#
######.###.
######.####
#######...#
#######..#.
#######..##
#######.#..
#######.#.#
#######.##.
#######.###
########...
########..#
########.#.
########.##
#########..
#########.#
##########.
###########
"""